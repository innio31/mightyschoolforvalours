<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exam Mode - Mighty School For Valours</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        :root {
            --primary: #1c3877;
            /* Deep blue */
            --secondary: #e23639;
            /* Vibrant red */
            --accent: #f97316;
            /* Orange (kept for consistency) */
            --light: #f0f4ff;
            /* Very light blue */
            --dark: #1f2937;
            /* Dark gray */
            --success: #22c55e;
            /* Success green */
            --warning: #eab308;
            /* Warning yellow */
            --danger: #ef4444;
            /* Danger red */
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #f5f7ff 0%, #f9f0f0 100%);
            color: var(--dark);
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(to right, var(--primary), white);
            color: white;
            text-align: center;
            padding: 2rem 1rem;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            clip-path: polygon(0 0, 100% 0, 100% 90%, 0 100%);
        }

        .logo-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 1rem;
            text-align: center;
        }

        .logo {
            height: 80px;
            margin-bottom: 15px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        .school-info {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .school-info h1 {
            margin: 0;
            font-size: 2rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            font-weight: 700;
        }

        .school-info h2 {
            margin: 5px 0 0 0;
            font-size: 1.2rem;
            font-weight: normal;
            opacity: 0.9;
        }

        .back-btn {
            position: absolute;
            left: 20px;
            top: 20px;
            color: white;
            font-size: 1.2rem;
            text-decoration: none;
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 30px;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateX(-5px);
        }

        .back-btn i {
            margin-right: 8px;
        }

        .main-container {
            max-width: 900px;
            margin: 2rem auto;
            padding: 0 20px;
        }

        /* Form container styles */
        .form-container {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border-radius: 15px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            border-left: 5px solid var(--primary);
            position: relative;
            overflow: hidden;
        }

        .form-container::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 120px;
            height: 120px;
            background: linear-gradient(45deg, var(--primary), #2a4ba0);
            border-radius: 0 0 0 100%;
            opacity: 0.1;
        }

        .form-title {
            text-align: center;
            color: var(--primary);
            margin-bottom: 2rem;
            font-size: 1.8rem;
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .form-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: linear-gradient(to right, var(--primary), #2a4ba0);
            border-radius: 2px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin-bottom: 0.8rem;
            font-weight: 600;
            color: var(--primary);
            font-size: 1.05rem;
        }

        input,
        select {
            width: 100%;
            padding: 14px;
            border: 2px solid #d1e0ff;
            border-radius: 8px;
            font-size: 1rem;
            background-color: var(--light);
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
        }

        input:focus,
        select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(28, 56, 119, 0.2);
        }

        .start-btn {
            display: block;
            width: 100%;
            background: linear-gradient(to right, var(--primary), #2a4ba0);
            color: white;
            padding: 16px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1.5rem;
            box-shadow: 0 5px 15px rgba(28, 56, 119, 0.3);
            position: relative;
            overflow: hidden;
        }

        .start-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: 0.5s;
        }

        .start-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(28, 56, 119, 0.4);
        }

        .start-btn:hover::before {
            left: 100%;
        }

        .info-box {
            background: rgba(28, 56, 119, 0.08);
            border-radius: 10px;
            padding: 1.5rem;
            margin-top: 2rem;
            border-left: 4px solid var(--primary);
            position: relative;
        }

        .info-box i {
            position: absolute;
            top: 15px;
            right: 15px;
            color: var(--primary);
            font-size: 1.5rem;
            opacity: 0.3;
        }

        /* Exam container styles (initially hidden) */
        .exam-container {
            display: none;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border-radius: 15px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            position: relative;
            overflow: hidden;
        }

        .exam-container::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100px;
            height: 100px;
            background: linear-gradient(45deg, var(--secondary), #f05053);
            border-radius: 100% 0 0 0;
            opacity: 0.1;
        }

        .exam-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1.2rem;
            border-bottom: 2px solid #e8eeff;
        }

        .student-info {
            flex: 1;
        }

        .student-info div {
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .student-name {
            color: var(--primary);
            font-weight: 600;
            font-size: 1.2rem;
        }

        .timer-container {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }

        .exam-type {
            font-size: 0.9rem;
            color: var(--primary);
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .timer {
            background: linear-gradient(to right, var(--primary), #2a4ba0);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 1.1rem;
            box-shadow: 0 4px 10px rgba(28, 56, 119, 0.3);
            display: flex;
            align-items: center;
        }

        .timer i {
            margin-right: 8px;
        }

        .timer.warning {
            background: linear-gradient(to right, var(--secondary), #f05053);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }

            100% {
                transform: scale(1);
            }
        }

        .progress-container {
            width: 100%;
            height: 8px;
            background: #d1e0ff;
            border-radius: 4px;
            margin: 1.5rem 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(to right, var(--primary), #2a4ba0);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .question-container {
            margin-bottom: 2.5rem;
        }

        .question-number {
            color: var(--primary);
            font-weight: 700;
            margin-bottom: 1.2rem;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .question-number span {
            background: var(--primary);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-size: 0.9rem;
        }

        .question-text {
            font-size: 1.15rem;
            margin-bottom: 1.8rem;
            line-height: 1.7;
            background: var(--light);
            padding: 1.5rem;
            border-radius: 10px;
            border-left: 4px solid var(--primary);
        }

        .options-container {
            margin-left: 0.5rem;
        }

        .option {
            margin-bottom: 1.2rem;
            display: flex;
            align-items: center;
            transition: all 0.3s ease;
            padding: 12px;
            border-radius: 8px;
        }

        .option:hover {
            background: #e8eeff;
            transform: translateX(5px);
        }

        .option input {
            width: auto;
            margin-right: 15px;
            cursor: pointer;
            width: 20px;
            height: 20px;
        }

        .option label {
            margin-bottom: 0;
            cursor: pointer;
            flex: 1;
            font-weight: 500;
            color: var(--dark);
        }

        /* Theory section styles */
        .theory-section {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 2px dashed var(--secondary);
        }

        .section-title {
            color: var(--primary);
            font-size: 1.3rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
        }

        .section-title i {
            margin-right: 10px;
            color: var(--primary);
        }

        .theory-question {
            margin-bottom: 1.5rem;
            padding: 1.5rem;
            background: var(--light);
            border-radius: 10px;
            border-left: 4px solid var(--secondary);
        }

        .theory-text {
            font-weight: 600;
            margin-bottom: 0.8rem;
            color: var(--dark);
            font-size: 1.1rem;
        }

        .theory-instruction {
            font-style: italic;
            color: #666;
            font-size: 0.95rem;
            padding-left: 1rem;
            border-left: 2px solid var(--secondary);
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 2.5rem;
        }

        .nav-btn {
            background: linear-gradient(to right, var(--primary), #2a4ba0);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            box-shadow: 0 4px 10px rgba(28, 56, 119, 0.3);
        }

        .nav-btn i {
            margin-right: 8px;
        }

        .nav-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(28, 56, 119, 0.4);
        }

        .nav-btn:disabled {
            background: #cbd5e1;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .submit-btn {
            background: linear-gradient(to right, var(--secondary), #f05053);
            color: white;
            border: none;
            padding: 14px 30px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 2.5rem auto 0;
            box-shadow: 0 5px 15px rgba(226, 54, 57, 0.3);
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(226, 54, 57, 0.4);
        }

        /* Submission confirmation */
        .confirmation-container {
            display: none;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border-radius: 15px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .confirmation-container::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 150px;
            height: 150px;
            background: linear-gradient(45deg, var(--success), #16a34a);
            border-radius: 0 0 0 100%;
            opacity: 0.1;
        }

        .confirmation-title {
            color: var(--primary);
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
            position: relative;
            display: inline-block;
        }

        .confirmation-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: linear-gradient(to right, var(--primary), #2a4ba0);
            border-radius: 2px;
        }

        .confirmation-message {
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
            line-height: 1.7;
            color: var(--dark);
        }

        .btn-group {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .confirm-btn {
            background: linear-gradient(to right, var(--primary), #2a4ba0);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(28, 56, 119, 0.3);
        }

        .confirm-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(28, 56, 119, 0.4);
        }

        .cancel-btn {
            background: linear-gradient(to right, #4b5563, #6b7280);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(107, 114, 128, 0.3);
        }

        .cancel-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(107, 114, 128, 0.4);
        }

        /* Results container */
        .result-container {
            display: none;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border-radius: 15px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .result-container::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 150px;
            height: 150px;
            background: linear-gradient(45deg, var(--success), #16a34a);
            border-radius: 0 0 0 100%;
            opacity: 0.1;
        }

        .result-title {
            color: var(--primary);
            margin-bottom: 1.5rem;
            font-size: 2rem;
            position: relative;
            display: inline-block;
        }

        .result-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: linear-gradient(to right, var(--primary), #2a4ba0);
            border-radius: 2px;
        }

        .result-message {
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
            line-height: 1.7;
            color: var(--dark);
        }

        .score-display {
            display: inline-block;
            position: relative;
            margin: 1.5rem 0;
        }

        .score {
            font-size: 3.5rem;
            font-weight: 800;
            color: var(--primary);
            position: relative;
            z-index: 2;
        }

        .score-bg {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 5rem;
            font-weight: 800;
            color: #e8eeff;
            z-index: 1;
        }

        .back-to-home {
            background: linear-gradient(to right, var(--primary), #2a4ba0);
            color: white;
            border: none;
            padding: 14px 30px;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(28, 56, 119, 0.3);
        }

        .back-to-home:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(28, 56, 119, 0.4);
        }

        /* Responsive design */
        @media (min-width: 768px) {
            .logo-container {
                flex-direction: row;
                justify-content: center;
                gap: 20px;
            }

            .logo {
                margin-bottom: 0;
            }

            .school-info {
                align-items: flex-start;
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 1.5rem 1rem;
            }

            .header h1 {
                font-size: 1.5rem;
            }

            .back-btn {
                position: relative;
                left: auto;
                top: auto;
                margin-bottom: 1rem;
                justify-content: center;
                display: inline-flex;
            }

            .exam-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1.2rem;
            }

            .timer-container {
                align-self: stretch;
                text-align: center;
                justify-content: center;
            }

            .btn-group {
                flex-direction: column;
                gap: 1rem;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .main-container {
                padding: 0 15px;
            }

            .form-container,
            .exam-container,
            .confirmation-container,
            .result-container {
                padding: 1.8rem;
            }

            .question-text {
                padding: 1.2rem;
            }
        }
    </style>
</head>

<body>
    <header class="header">
        <a href="cbt.html" class="back-btn animate__animated animate__fadeIn">
            <i class="fas fa-arrow-left"></i> Back to Home
        </a>
        <div class="logo-container">
            <img src="images/logo.png" alt="MVS logo" class="logo">
            <div class="school-info">
                <h1>Mighty School For Valours</h1>
                <h2>Examination Portal</h2>
            </div>
        </div>
    </header>

    <div class="main-container">
        <!-- Registration Form -->
        <div class="form-container animate__animated animate__fadeInUp" id="registrationForm">
            <h2 class="form-title">Exam Registration</h2>

            <div class="form-grid">
                <div class="form-group">
                    <label for="studentName"><i class="fas fa-user"></i> Full Name:</label>
                    <input type="text" id="studentName" placeholder="Enter your full name as registered">
                </div>

                <div class="form-group">
                    <label for="studentClass"><i class="fas fa-graduation-cap"></i> Class:</label>
                    <select id="studentClass">
                        <option value="">-- Select Class --</option>
                        <option value="jss1">JSS 1</option>
                        <option value="jss2">JSS 2</option>
                        <option value="jss3">JSS 3</option>
                        <option value="sss1">SSS 1</option>
                        <option value="sss2">SSS 2</option>
                        <option value="sss3">SSS 3</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="academicSession"><i class="fas fa-calendar-alt"></i> Academic Session:</label>
                    <select id="academicSession">
                        <option value="">-- Select Session --</option>
                        <option value="2025_2026">2025/2026</option>
                        <option value="2026_2027">2026/2027</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="term"><i class="fas fa-book"></i> Term:</label>
                    <select id="term">
                        <option value="">-- Select Term --</option>
                        <option value="1st">1st Term</option>
                        <option value="2nd">2nd Term</option>
                        <option value="3rd">3rd Term</option>
                        <option value="summer">Summer</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="examType"><i class="fas fa-file-alt"></i> Exam Type:</label>
                    <select id="examType">
                        <option value="">-- Select Exam Type --</option>
                        <option value="ca">Continuous Assessment</option>
                        <option value="midterm">Midterm Exam</option>
                        <option value="exam">End of Term Exam</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="subject"><i class="fas fa-book-open"></i> Select Subject:</label>
                    <select id="subject">
                        <option value="">-- Select Subject --</option>
                        <!-- Subjects will be populated by JavaScript -->
                    </select>
                </div>
            </div>

            <button class="start-btn" id="startExam">
                <i class="fas fa-play-circle"></i> Begin Examination
            </button>

            <div class="info-box">
                <i class="fas fa-info-circle"></i>
                <p><strong>Note:</strong> The exam consists of both objective (30 minutes) and theory (30 minutes)
                    sections. Objective answers are auto-graded while theory answers will be graded by your teacher.</p>
            </div>
        </div>

        <!-- Exam Container (hidden initially) -->
        <div class="exam-container" id="examContainer">
            <div class="exam-header">
                <div class="student-info">
                    <div class="student-name" id="studentNameDisplay"></div>
                    <div id="studentClassDisplay"></div>
                    <div id="subjectDisplay"></div>
                </div>
                <div class="timer-container">
                    <div class="exam-type" id="examTypeDisplay"></div>
                    <div class="timer" id="timer">
                        <i class="fas fa-clock"></i> <span>30:00</span>
                    </div>
                </div>
            </div>

            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>

            <div class="question-container" id="questionContainer">
                <!-- Questions will be inserted here by JavaScript -->
            </div>

            <div class="nav-buttons">
                <button class="nav-btn" id="prevBtn" disabled>
                    <i class="fas fa-chevron-left"></i> Previous
                </button>
                <button class="nav-btn" id="nextBtn">
                    Next <i class="fas fa-chevron-right"></i>
                </button>
            </div>

            <button class="submit-btn" id="submitBtn">
                <i class="fas fa-paper-plane"></i> Submit Exam
            </button>
        </div>

        <!-- Confirmation Container (hidden initially) -->
        <div class="confirmation-container" id="confirmationContainer">
            <h2 class="confirmation-title">Confirm Submission</h2>
            <div class="confirmation-message">
                Are you sure you want to submit your exam? You won't be able to make changes after submission.
            </div>
            <div class="btn-group">
                <button class="confirm-btn" id="confirmSubmit">
                    <i class="fas fa-check"></i> Yes, Submit
                </button>
                <button class="cancel-btn" id="cancelSubmit">
                    <i class="fas fa-times"></i> No, Continue
                </button>
            </div>
        </div>

        <!-- Results Container (hidden initially) -->
        <div class="result-container" id="resultContainer">
            <h2 class="result-title">Exam Submitted</h2>
            <div class="result-message">
                Your exam has been submitted successfully. Your objective answers have been graded automatically.
            </div>
            <div class="score-display">
                <div class="score-bg" id="scoreBg">SCORE</div>
                <div class="score" id="scoreDisplay">0%</div>
            </div>
            <div class="result-message">
                Your theory answers will be graded by your teacher and the results will be available later.
            </div>
            <button class="back-to-home" id="backToHome">
                <i class="fas fa-home"></i> Back to Home
            </button>
        </div>
    </div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDDJln5uWh_xmDA7bXowbFT-yL6zlBPtRg",
            authDomain: "mightyschoolforvalours-91aa4.firebaseapp.com",
            projectId: "mightyschoolforvalours-91aa4",
            storageBucket: "mightyschoolforvalours-91aa4.firebasestorage.app",
            messagingSenderId: "778024125256",
            appId: "1:778024125256:web:31d482406bf06a2125a97d",
            measurementId: "G-C2NY58GRFT"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // ====================
        // EXAM QUESTION DATABASE
        // ====================
        const examQuestions = {
            jss1: {
                mathematics: {
                    ca: [
                        {
                            question: "What is 15 + 27?",
                            options: ["32", "42", "52", "62"],
                            answer: 1
                        },
                        {
                            question: "How many sides does a triangle have?",
                            options: ["2", "3", "4", "5"],
                            answer: 1
                        },
                        {
                            question: "What is 12 × 5?",
                            options: ["50", "60", "70", "80"],
                            answer: 1
                        },
                        {
                            question: "Which of these is an even number?",
                            options: ["11", "13", "15", "18"],
                            answer: 3
                        },
                        {
                            question: "What is 100 ÷ 4?",
                            options: ["20", "25", "30", "35"],
                            answer: 1
                        }
                    ],
                    midterm: [
                        {
                            question: "What is the place value of 7 in 573?",
                            options: ["Units", "Tens", "Hundreds", "Thousands"],
                            answer: 1
                        },
                        {
                            question: "What is 3/4 expressed as a decimal?",
                            options: ["0.25", "0.5", "0.75", "1.0"],
                            answer: 2
                        },
                        {
                            question: "Which of these numbers is a prime number?",
                            options: ["4", "9", "11", "15"],
                            answer: 2
                        },
                        {
                            question: "What is the perimeter of a square with side length 5cm?",
                            options: ["10cm", "15cm", "20cm", "25cm"],
                            answer: 2
                        },
                        {
                            question: "Solve for x: x + 8 = 15",
                            options: ["5", "6", "7", "8"],
                            answer: 2
                        }
                    ],
                    exam: [
                        {
                            question: "What is the area of a rectangle with length 8cm and width 5cm?",
                            options: ["13cm²", "26cm²", "35cm²", "40cm²"],
                            answer: 3
                        },
                        {
                            question: "What is the value of 5 squared?",
                            options: ["10", "15", "20", "25"],
                            answer: 3
                        },
                        {
                            question: "Which fraction is equivalent to 0.5?",
                            options: ["1/4", "1/2", "3/4", "1/1"],
                            answer: 1
                        },
                        {
                            question: "What is the sum of the angles in a triangle?",
                            options: ["90°", "180°", "270°", "360°"],
                            answer: 1
                        },
                        {
                            question: "If a book costs ₦500 and you buy 3 copies, how much do you pay?",
                            options: ["₦1000", "₦1500", "₦2000", "₦2500"],
                            answer: 1
                        }
                    ]
                },
                english: {
                    ca: [
                        {
                            question: "Which of these is a noun?",
                            options: ["run", "happy", "school", "quickly"],
                            answer: 2
                        },
                        {
                            question: "Choose the correct spelling:",
                            options: ["Accomodate", "Acommodate", "Accommodate", "Acomodate"],
                            answer: 2
                        }
                    ],
                    midterm: [
                        {
                            question: "What is the past tense of 'go'?",
                            options: ["goed", "gone", "went", "going"],
                            answer: 2
                        },
                        {
                            question: "Which word is an adjective?",
                            options: ["happiness", "quickly", "beautiful", "running"],
                            answer: 2
                        }
                    ],
                    exam: [
                        {
                            question: "Identify the adverb in: 'He ran quickly to catch the bus.'",
                            options: ["He", "ran", "quickly", "bus"],
                            answer: 2
                        },
                        {
                            question: "Which sentence is correct?",
                            options: [
                                "She don't like apples",
                                "She doesn't likes apples",
                                "She doesn't like apples",
                                "She not like apples"
                            ],
                            answer: 2
                        }
                    ]
                },
                basic_science: {
                    exam: [
                        {
                            question: "What is the chemical symbol for water?",
                            options: ["H2O", "CO2", "NaCl", "O2"],
                            answer: 0
                        }
                    ]
                }
            },
            jss2: {
                mathematics: {
                    ca: [
                        {
                            question: "What is 25 × 4?",
                            options: ["75", "100", "125", "150"],
                            answer: 1
                        }
                    ]
                }
            }
        };

        // ====================
        // THEORY QUESTIONS DATABASE
        // ====================
        const theoryQuestions = {
            jss1: {
                mathematics: {
                    ca: [
                        {
                            question: "Explain how to add 35 and 47 using the column method.",
                            instruction: "Write step-by-step instructions."
                        },
                        {
                            question: "A rectangle has a length of 8cm and width of 5cm. Calculate its area and perimeter.",
                            instruction: "Show your working."
                        }
                    ],
                    midterm: [
                        {
                            question: "Solve the equation: 2x + 5 = 15",
                            instruction: "Show each step of your solution."
                        },
                        {
                            question: "List the first 5 prime numbers and explain why they are prime.",
                            instruction: "Be clear in your explanation."
                        }
                    ],
                    exam: [
                        {
                            question: "A shop sells pencils at ₦20 each. If you have ₦500, how many pencils can you buy and how much change will you get?",
                            instruction: "Show your calculations."
                        },
                        {
                            question: "Explain the difference between a square and a rectangle.",
                            instruction: "Give at least 3 differences."
                        }
                    ]
                },
                english: {
                    exam: [
                        {
                            question: "Write a short paragraph (about 5 sentences) about your favorite teacher.",
                            instruction: "Pay attention to grammar and punctuation."
                        }
                    ]
                }
            }
        };

        // ====================
        // DOM ELEMENTS
        // ====================
        const registrationForm = document.getElementById('registrationForm');
        const examContainer = document.getElementById('examContainer');
        const confirmationContainer = document.getElementById('confirmationContainer');
        const resultContainer = document.getElementById('resultContainer');
        const startExamBtn = document.getElementById('startExam');
        const submitBtn = document.getElementById('submitBtn');
        const confirmSubmitBtn = document.getElementById('confirmSubmit');
        const cancelSubmitBtn = document.getElementById('cancelSubmit');
        const backToHomeBtn = document.getElementById('backToHome');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const timerElement = document.getElementById('timer');
        const progressBar = document.getElementById('progressBar');
        const questionContainer = document.getElementById('questionContainer');
        const subjectSelect = document.getElementById('subject');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const studentClassDisplay = document.getElementById('studentClassDisplay');
        const subjectDisplay = document.getElementById('subjectDisplay');
        const examTypeDisplay = document.getElementById('examTypeDisplay');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const scoreBg = document.getElementById('scoreBg');

        // ====================
        // GLOBAL VARIABLES
        // ====================
        let currentQuestions = [];
        let currentTheoryQuestions = [];
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let timerInterval;
        let timeLeft = 1800; // 30 minutes in seconds
        let studentData = {};

        // ====================
        // INITIALIZATION
        // ====================
        document.addEventListener('DOMContentLoaded', function () {
            // Populate subjects
            populateSubjects();

            // Event listeners
            startExamBtn.addEventListener('click', startExam);
            submitBtn.addEventListener('click', showConfirmation);
            confirmSubmitBtn.addEventListener('click', submitExam);
            cancelSubmitBtn.addEventListener('click', hideConfirmation);
            backToHomeBtn.addEventListener('click', goBackHome);
            prevBtn.addEventListener('click', showPreviousQuestion);
            nextBtn.addEventListener('click', showNextQuestion);

            // Class change event to update subjects
            document.getElementById('studentClass').addEventListener('change', populateSubjects);
        });

        // ====================
        // FUNCTIONS
        // ====================
        function populateSubjects() {
            const classValue = document.getElementById('studentClass').value;
            subjectSelect.innerHTML = '<option value="">-- Select Subject --</option>';

            if (classValue) {
                const subjects = Object.keys(examQuestions[classValue] || {});
                subjects.forEach(subject => {
                    const option = document.createElement('option');
                    option.value = subject;
                    option.textContent = subject.charAt(0).toUpperCase() + subject.slice(1).replace('_', ' ');
                    subjectSelect.appendChild(option);
                });
            }
        }

        function startExam() {
            const studentName = document.getElementById('studentName').value.trim();
            const studentClass = document.getElementById('studentClass').value;
            const academicSession = document.getElementById('academicSession').value;
            const term = document.getElementById('term').value;
            const examType = document.getElementById('examType').value;
            const subject = document.getElementById('subject').value;

            // Validate form
            if (!studentName || !studentClass || !academicSession || !term || !examType || !subject) {
                alert('Please fill in all fields before starting the exam.');
                return;
            }

            // Check if questions exist for this selection
            if (!examQuestions[studentClass] || !examQuestions[studentClass][subject] || !examQuestions[studentClass][subject][examType]) {
                alert('No questions available for this selection. Please try another combination.');
                return;
            }

            // Store student data
            studentData = {
                name: studentName,
                class: studentClass,
                session: academicSession,
                term: term,
                examType: examType,
                subject: subject
            };

            // Get questions
            currentQuestions = examQuestions[studentClass][subject][examType];
            currentTheoryQuestions = theoryQuestions[studentClass] && theoryQuestions[studentClass][subject] &&
                theoryQuestions[studentClass][subject][examType] || [];

            // Initialize user answers
            userAnswers = new Array(currentQuestions.length).fill(null);

            // Update display
            studentNameDisplay.textContent = studentName;
            studentClassDisplay.textContent = `Class: ${studentClass.toUpperCase()}`;
            subjectDisplay.textContent = `Subject: ${subject.charAt(0).toUpperCase() + subject.slice(1).replace('_', ' ')}`;
            examTypeDisplay.textContent = `${examType.toUpperCase()} Exam`;

            // Switch to exam view
            registrationForm.style.display = 'none';
            examContainer.style.display = 'block';

            // Start timer
            startTimer();

            // Show first question
            showQuestion(0);
        }

        function startTimer() {
            clearInterval(timerInterval);
            timeLeft = 1800; // 30 minutes

            timerInterval = setInterval(() => {
                timeLeft--;

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    submitExam();
                }

                updateTimerDisplay();

                // Add warning class when less than 5 minutes remain
                if (timeLeft === 300) {
                    timerElement.classList.add('warning');
                }
            }, 1000);

            updateTimerDisplay();
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timerElement.innerHTML = `<i class="fas fa-clock"></i> <span>${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}</span>`;
        }

        function showQuestion(index) {
            currentQuestionIndex = index;
            questionContainer.innerHTML = '';

            // Update progress bar
            const progress = ((index + 1) / currentQuestions.length) * 100;
            progressBar.style.width = `${progress}%`;

            // Update navigation buttons
            prevBtn.disabled = index === 0;
            nextBtn.disabled = index === currentQuestions.length - 1;

            // Create and append question
            const question = currentQuestions[index];
            const questionElement = document.createElement('div');
            questionElement.className = 'question';

            const questionNumber = document.createElement('div');
            questionNumber.className = 'question-number';
            questionNumber.innerHTML = `<span>${index + 1}</span> Question ${index + 1} of ${currentQuestions.length}`;

            const questionText = document.createElement('div');
            questionText.className = 'question-text';
            questionText.textContent = question.question;

            const optionsContainer = document.createElement('div');
            optionsContainer.className = 'options-container';

            question.options.forEach((option, i) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';

                const input = document.createElement('input');
                input.type = 'radio';
                input.name = 'answer';
                input.value = i;
                input.id = `option-${i}`;
                input.checked = userAnswers[index] === i;
                input.addEventListener('change', () => {
                    userAnswers[index] = i;
                });

                const label = document.createElement('label');
                label.htmlFor = `option-${i}`;
                label.textContent = option;

                optionElement.appendChild(input);
                optionElement.appendChild(label);
                optionsContainer.appendChild(optionElement);
            });

            questionElement.appendChild(questionNumber);
            questionElement.appendChild(questionText);
            questionElement.appendChild(optionsContainer);
            questionContainer.appendChild(questionElement);

            // Add theory section if we're on the last question
            if (index === currentQuestions.length - 1 && currentTheoryQuestions.length > 0) {
                addTheorySection();
            }
        }

        function addTheorySection() {
            const theorySection = document.createElement('div');
            theorySection.className = 'theory-section';

            const sectionTitle = document.createElement('div');
            sectionTitle.className = 'section-title';
            sectionTitle.innerHTML = '<i class="fas fa-pen-fancy"></i> Theory Section';

            theorySection.appendChild(sectionTitle);

            currentTheoryQuestions.forEach((theoryQuestion, index) => {
                const theoryElement = document.createElement('div');
                theoryElement.className = 'theory-question';

                const theoryText = document.createElement('div');
                theoryText.className = 'theory-text';
                theoryText.textContent = `${index + 1}. ${theoryQuestion.question}`;

                const theoryInstruction = document.createElement('div');
                theoryInstruction.className = 'theory-instruction';
                theoryInstruction.textContent = theoryQuestion.instruction;

                const textarea = document.createElement('textarea');
                textarea.rows = 5;
                textarea.placeholder = 'Type your answer here...';
                textarea.style.width = '100%';
                textarea.style.marginTop = '10px';
                textarea.style.padding = '10px';
                textarea.style.borderRadius = '5px';
                textarea.style.border = '1px solid #d1e0ff';
                textarea.style.fontFamily = 'Poppins, sans-serif';

                theoryElement.appendChild(theoryText);
                theoryElement.appendChild(theoryInstruction);
                theoryElement.appendChild(textarea);

                theorySection.appendChild(theoryElement);
            });

            questionContainer.appendChild(theorySection);
        }

        function showPreviousQuestion() {
            if (currentQuestionIndex > 0) {
                showQuestion(currentQuestionIndex - 1);
            }
        }

        function showNextQuestion() {
            if (currentQuestionIndex < currentQuestions.length - 1) {
                showQuestion(currentQuestionIndex + 1);
            }
        }

        function showConfirmation() {
            examContainer.style.display = 'none';
            confirmationContainer.style.display = 'block';
        }

        function hideConfirmation() {
            confirmationContainer.style.display = 'none';
            examContainer.style.display = 'block';
        }

        function submitExam() {
            clearInterval(timerInterval);

            // Calculate score
            const score = calculateScore();
            const percentage = Math.round((score / currentQuestions.length) * 100);

            // Update score display
            scoreDisplay.textContent = `${percentage}%`;
            scoreBg.textContent = `${percentage}%`;

            // Save results to Firebase
            saveResults(percentage);

            // Show results
            confirmationContainer.style.display = 'none';
            resultContainer.style.display = 'block';
        }

        function calculateScore() {
            let score = 0;
            userAnswers.forEach((answer, index) => {
                if (answer === currentQuestions[index].answer) {
                    score++;
                }
            });
            return score;
        }

        function saveResults(percentage) {
            const timestamp = new Date().toISOString();
            const resultData = {
                studentName: studentData.name,
                studentClass: studentData.class,
                academicSession: studentData.session,
                term: studentData.term,
                examType: studentData.examType,
                subject: studentData.subject,
                score: percentage,
                timestamp: timestamp
            };

            // Save to Firebase
            database.ref('examResults/' + timestamp.replace(/[.#$[\]]/g, '_')).set(resultData)
                .then(() => {
                    console.log('Results saved successfully');
                })
                .catch((error) => {
                    console.error('Error saving results: ', error);
                });
        }

        function goBackHome() {
            window.location.href = 'index.html';
        }
    </script>
</body>

</html>